## 1. 画像処理の基礎
- 画像の基礎知識
  1. 画像処理での約束事になれる
  - 原点が左上からスタート
    - x軸が右方向
    - y軸が下方向
  2. Open CV 独自の約束事になれる
  - 画素の順番は（B ,G, R）の順番で入っており、画素値は０−２５５で表す
  - Numpy arrly に y, x, color の順番に画素値を格納する
#### code
  img [300][960][0]
        y    x   B
- 上記のような順番で画素値にアクセスする必要がある
- height, width を取得する時も -> print(h, w)　の順番で取得しなければ混乱する
## 2. 色空間・グレースケール
1.  RGB以外にもHSVなど様々な色の表し方がある
- <u>色空間とは色の表方</u>
- RGB
  - R（RED）:赤 0~255
  - G（GREEN）:緑 0~255
  - B（BLUE）:青 0~255
  - RGBを指定することによって一つの座標が生まれる。それによって様々な色を表現できる
- HSV
  - H（Hue）:色相 0-359
    - 角度によって色の種類を表す
  - S（Saturation）:彩度 0-100%
    - Hue で指定した色がどれくらい含まれているのかを％で表す
  - V（Value）:明度 0-100%
    - 色の明るさを表ている
  - HSVでのメリットは色が表しやすい
    - H：３０〜６０で黄色っぽい色を抜き出す事ができる
    - これをRGBで表そうとするとすごく手間がかかる
- <u>Open CV では…（注意点）</u>
  - H：０−１７９　（0-359/2= 179）360/2=180：通常の定義の半分で表される
  - S：０−２５５
  - V：０−２５５
  - **整数しか扱えない**：２５６段階しか扱えないという制約上。上記のような表し方になっている
2. グレースケールのメリットを理解する
- 色の強度という１つの情報にまとめあげる
- Gray = 0.2989 R + 0.5870 G + 0.1140 B　係数で掛け合わせる
- メリット
  - RGB ー＞＞　グレースケール　ー＞＞　演算量が三分の一になる
  - ２値化の時にやり易い
## 3. γ（ガンマ） 変換
1. 画像の明るさの変換方法
   - γ が 1 より小さい場合
     - 画像が暗くなる
   - γ が 1 より大きい場合
     - 画像が明るくなる
## 4. アファイン変換
1. アファイン変換とは回転・平行移動などの線形変換
- 詳細は jupyter notebook 参照（image_analysis.ipynb）
## 5. 畳み込み
- 周囲の情報を使用して自分の画素値の更新を行う
  1. フィルターを適用する
     - 平滑化フィルターを用意
  2. 着目画素の周囲で
     - (画素値)-(フィルター)を行い = 畳み込み
     - **周りの情報をフィルターで重み付けをしながら取り込んで、値が更新される**
     - ノイズが取り除かれる = 平滑化フィルターの役割をしている
  3. 全ての画像について畳み込みを行う
### メリット
- 畳み込みをする事によって<u>画像のノイズが消える</u>
### デメリット
- 画像がぼやける
  - 周りの情報を取り込むのでメリハリ(シャープさ)がなくなる
### 畳み込みとは…
- フィルターで重みをつけながら、周囲の情報を使って自分の画素値を更新する
#### 画像の微分や平滑化などの様々なフィルターがある
- 平滑化フィルター , Sobelフィルター(画像の前後で引き算、縦方向：エッジ検出)
- フィルターは自ら設定できるので、様々フィルターを設定して畳み込みを行う事ができる
## 6. 画像の微分
1. 微分とは小さな区間の関数の変化
- jupyter notebook 参照（image_analysis.ipynb）
## 7. Canny のエッジ検出
- Canny はノイズをうまく取り除き、エッジを検出する
- うまくエッジだけを残している。線画に近い
### Canny のアルゴリズムは４段階
1. Gaussianfilterでぼかす
   - ぼかすことでノイズを取り除く
2. Sobelfilterで微分する
   - x,y 方向のエッジを検出
3. 極大点を探す
   - エッジを探す為 -> 極大点(白・黒・白：山形の形)
   - ２乗はとってスクエアルートになおす
   - グラデーション部分が残ってくる
4. 2段階の閾値処理でエッジを残す
   - ノイズは消す。細かいエッジは残す
   - ２段階でエッジ検出
## 8. 直線と円の検出
1. 直線は２つのパラメーターで決まる
   - jupyter notebook 参照（image_analysis.ipynb）
## 9. モルフォロジー演算
- モルフォロジー -> 形態という意味
- モノの形にまつわる処理
### モルフォロジー演算は膨張と収縮からなる
- erode(ヘロド) -> 収縮
  - ２つの図形が分離
  - 本来であれば、分離されているはずだがノイズで繋がってしまっている場合に使用する
- 元画像
  - ２つの図形を連結する細い線
- dilate(ディレート) -> 膨張
  - ２つの図形がより一体化
#### ピクセルを収縮させたり、膨張させると図形を分離できる
### オープニング・クロージングは図形の大きさを保ちながら形状操作
- オープニング
  - 収縮 -> 膨張
  - ノイズが消えた
- 元画像
  - 黒画面にノイズ
- クロージング
  - 膨張 -> 収縮
  - ノイズの大きさはそのまま
- モルフォロジー演算を使うことで、ものを分離したり、ノイズを消せる
## 10. 特徴抽出
- パターン認識に役立つ情報量の多い部分の事
  - <u>コーナー</u>
    - 情報量が多い・特徴量の代表的な例
    - エッジとエッジが交わっている場所
  - <u>エッジ</u>
    - 中間の情報量・大まかな場所の特定はできる。詳細は分からない
  - <u>フラット</u>
    - 情報量が少ない・何処にあるか分からない
    - 画像の中に方向性がない
### 特徴抽出のアルゴリズム
- フラットな領域は固有値の大きいものがない
  - <u>フラットの場合</u>
    - **画像の中に方向性がない**
    - 対角化 -> 固有ベクトルを求める -> グラフは満遍なくどの方向にも伸びる
    - 固有値も全ての要素が少しづつ入っていて方向性がない
  - <u>エッジの場合</u>
    - エッジに対して垂直に入っていく固有のベクトルの成分が存在する
    - 上記の固有ベクトルだけ数値が大きくなる(対応する固有値が大きくなる)
  - <u>コーナーの場合</u>
    - エッジが２つあるので２つの大きな固有のベクトルがある
#### フラット・エッジ・コーナーの分け方
- 固有値の大きい固有ベクトルの個数で画像の特徴を抽出できる
  - 0個 -> フラット
  - 1個 -> エッジ
  - 2個 -> コーナー
- 特徴抽出のやり方の１つ
  - <u>Harris(ハリス)のコーナー検出</u>
#### 実際には様々な特徴抽出・記述(アルゴリズム)がある
- <u>SIFT(シフト)</u>
  - 特徴量が128次元 = メモリ負荷大
  - 特許取得のため商用利用不可
- <u>SURF(サーフ)</u>
  - SIFTを高速化
  - 特許取得のため商用利用不可
- <u>ORB(オーブ)</u>
  - 特徴量を２値化 = 速い
  - 特許問題がない
- <u>KAZE(ケーズ)</u>
  - Gaussian カーネルではなく非線形filter 使用
  - 特許問題がない
- <u>AKAZE(アクセレイトケーズ)</u>
  - KAZE を高速化
  - 特許問題がない

